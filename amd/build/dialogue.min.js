define(["exports","core/modal","editor_tiny/options"],(function(e,t,n){"use strict";class o extends t{static TYPE="tiny_pumukitmedia/modal";static TEMPLATE="tiny_pumukitmedia/modal";registerEventListeners(){this.setRemoveOnClose(!0),super.registerEventListeners(),this.registerCloseOnCancel()}}o.registerModalType();
/**
     * Tiny Pumukitmedia common values.
     *
     * @module      tiny_pumukitmedia/common
     * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
     */
const i="tiny_pumukitmedia/plugin",s=n.getPluginOptionName(i,"pumukitmediaurl"),a=n.getPluginOptionName(i,"dialogtitle"),l=n.getPluginOptionName(i,"username"),r=n.getPluginOptionName(i,"email"),m=n.getPluginOptionName(i,"hash"),d=n.getPluginOptionName(i,"showpr"),c=n.getPluginOptionName(i,"showplaylist"),p=n.getPluginOptionName(i,"showsharedvideos");
/**
     * Options helper for the Moodle Tiny Pumukitmedia plugin.
     *
     * @module      tiny_pumukitmedia/options
     * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
     */e.openPumukitDialogue=async e=>{const t=(e=>e.options.get(a))(e),n=(e=>{const t=e.options.get(s);return"string"==typeof t?t.trim():""})(e),i=(e=>e.options.get(m))(e),u=(e=>e.options.get(l))(e),g=(e=>e.options.get(r))(e),h=document.documentElement.lang||"en",y=(e=>e.options.get(d))(e),v=(e=>e.options.get(c))(e),w=(e=>e.options.get(p))(e),f={modaltitle:t,pumukitUrl:n,hash:i,username:u,email:g,lang:h,showpr:y,showplaylist:v,showsharedvideos:w},E="pumukitmedia_iframe_sso",k=async()=>{try{const t=await o.create({templateContext:f,large:!0});t.show(),function(e,t,n){e.getRoot().on("click",".nav-tabs .nav-link",(function(t){t.preventDefault();const n=e.getRoot()[0],o=t.target,i=o.getAttribute("href");n.querySelectorAll(".nav-tabs .nav-link").forEach((e=>{e.classList.remove("active")})),n.querySelectorAll(".tab-pane").forEach((e=>{e.classList.remove("show","active")})),o.classList.add("active");const s=n.querySelector(i);s&&s.classList.add("show","active")}));const o=i=>{const s=i.data;if(!s||!s.mmId&&!s.url&&!s.playlist)return;let a="";s.url?a=s.url:s.playlist?a=`${n}/openedx/openedx/playlist/embed/${s.playlist}`:s.mmId&&(a=`${n}/openedx/openedx/embed/${s.mmId}`);const l=`<a href="${a}" target="_blank" class="pumukit-media-link">${a}</a>`;t.insertContent(l),e.hide(),window.removeEventListener("message",o)};window.addEventListener("message",o),e.getRoot().on("hidden.bs.modal",(()=>{window.removeEventListener("message",o)}))}(t,e,n)}catch(e){console.error("Error creando la modal de PuMuKIT:",e)}};if(document.getElementById(E))k();else{const e=document.createElement("iframe");e.id=E,e.style.display="none",e.src=`${n}/openedx/sso/manager?hash=${i}&username=${u}&email=${g}&lang=${h}`,e.allow="microphone; camera; display-capture; clipboard-write",e.onload=k,document.body.appendChild(e)}}}));
//# sourceMappingURL=dialogue.min.js.map
