{"version":3,"file":"plugin.min.js","sources":["../src/common.js","../src/options.js","../src/plugin.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Pumukitmedia common values.\n *\n * @module      tiny_pumukitmedia/common\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const pluginName = 'tiny_pumukitmedia/plugin';\nexport const component = 'tiny_pumukitmedia';\nexport const pluginButtonName = 'pumukitmedia';\n","/**\n * Options helper for the Moodle Tiny Pumukitmedia plugin.\n *\n * @module      tiny_pumukitmedia/options\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {pluginName} from './common';\nimport {getPluginOptionName} from 'editor_tiny/options';\n\nconst urlOption = getPluginOptionName(pluginName, 'pumukitmediaurl');\nconst titleOption = getPluginOptionName(pluginName, 'dialogtitle');\nconst usernameOption = getPluginOptionName(pluginName, 'username');\nconst emailOption = getPluginOptionName(pluginName, 'email');\nconst hashOption = getPluginOptionName(pluginName, 'hash');\nconst showPrOption = getPluginOptionName(pluginName, 'showpr');\nconst showPlaylistOption = getPluginOptionName(pluginName, 'showplaylist');\nconst showSharedOption = getPluginOptionName(pluginName, 'showsharedvideos');\n\nexport const register = (editor) => {\n    editor.options.register(urlOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(titleOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(usernameOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(emailOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(hashOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(showPrOption, {\n        processor: 'boolean',\n        default: true,\n    });\n    editor.options.register(showPlaylistOption, {\n        processor: 'boolean',\n        default: false,\n    });\n    editor.options.register(showSharedOption, {\n        processor: 'boolean',\n        default: true,\n    });\n};\n\n// Funciones de ayuda\nexport const getPumukitUrl = (editor) => {\n    const value = editor.options.get(urlOption);\n    return typeof value === 'string' ? value.trim() : '';\n};\nexport const getDialogTitle = (editor) => editor.options.get(titleOption);\nexport const getUsername = (editor) => editor.options.get(usernameOption);\nexport const getEmail = (editor) => editor.options.get(emailOption);\nexport const getHash = (editor) => editor.options.get(hashOption);\nexport const getShowPr = (editor) => editor.options.get(showPrOption);\nexport const getShowPlaylist = (editor) => editor.options.get(showPlaylistOption);\nexport const getShowSharedVideos = (editor) => editor.options.get(showSharedOption);\n","import {getTinyMCE} from 'editor_tiny/loader';\nimport {getPluginMetadata} from 'editor_tiny/utils';\nimport {openPumukitDialogue} from 'tiny_pumukitmedia/dialogue';\nimport * as Configuration from 'tiny_pumukitmedia/configuration';\nimport * as Options from './options';\nimport {\n    component,\n    pluginName,\n    pluginButtonName\n} from './common';\n\n/**\n * Tiny PumukitMedia plugin for Moodle.\n *\n * @module      tiny_pumukitmedia/plugin\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nexport default new Promise(async (resolve) => {\n    const [tinymce, pluginMetadata] = await Promise.all([\n        getTinyMCE(),\n        getPluginMetadata(component, pluginName)\n    ]);\n\n    tinymce.PluginManager.add(`${component}/plugin`, (editor) => {\n        Options.register(editor);\n\n        const pumukitIcon = `\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1Zm1 2v14h14V5H5Zm4.8 2.6 5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4Z\" fill=\"red\"></path>\n            </svg>\n        `;\n\n        editor.ui.registry.addIcon('pumukit', pumukitIcon);\n\n        editor.ui.registry.addButton(pluginButtonName, {\n            icon: 'pumukit',\n            tooltip: Options.getDialogTitle(editor) || 'Insert PuMuKIT Media',\n            onAction: () => {\n                openPumukitDialogue(editor);\n            }\n        });\n\n        editor.ui.registry.addMenuItem(pluginButtonName, {\n            text: 'Pumukit Media',\n            icon: 'pumukit',\n            classes: 'pumukitmedia-button',\n            onAction: () => {\n                openPumukitDialogue(editor);\n            }\n        });\n\n        return pluginMetadata;\n    });\n\n    resolve([`${component}/plugin`, Configuration]);\n});\n"],"names":["pluginName","component","pluginButtonName","urlOption","getPluginOptionName","titleOption","usernameOption","emailOption","hashOption","showPrOption","showPlaylistOption","showSharedOption","getDialogTitle","editor","options","get","Promise","async","resolve","tinymce","pluginMetadata","all","getTinyMCE","getPluginMetadata","PluginManager","add","register","processor","default","Options.register","ui","registry","addIcon","addButton","icon","tooltip","Options.getDialogTitle","onAction","openPumukitDialogue","addMenuItem","text","classes","Configuration"],"mappings":";;;;;;OAsBO,MAAMA,EAAa,2BACbC,EAAY,oBACZC,EAAmB,eCd1BC,EAAYC,EAAAA,oBAAoBJ,EAAY,mBAC5CK,EAAcD,EAAAA,oBAAoBJ,EAAY,eAC9CM,EAAiBF,EAAAA,oBAAoBJ,EAAY,YACjDO,EAAcH,EAAAA,oBAAoBJ,EAAY,SAC9CQ,EAAaJ,EAAAA,oBAAoBJ,EAAY,QAC7CS,EAAeL,EAAAA,oBAAoBJ,EAAY,UAC/CU,EAAqBN,EAAAA,oBAAoBJ,EAAY,gBACrDW,EAAmBP,EAAAA,oBAAoBJ,EAAY,oBA0C5CY,EAAkBC,GAAWA,EAAOC,QAAQC,IAAIV,UC1C9C,IAAIW,SAAQC,MAAOC,IAC9B,MAAOC,EAASC,SAAwBJ,QAAQK,IAAI,CAChDC,eACAC,EAAiBA,kBAACtB,EAAWD,KAGjCmB,EAAQK,cAAcC,IAAI,GAAGxB,YAAqBY,IDJ9B,CAACA,IACrBA,EAAOC,QAAQY,SAASvB,EAAW,CAC/BwB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASrB,EAAa,CACjCsB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASpB,EAAgB,CACpCqB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASnB,EAAa,CACjCoB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASlB,EAAY,CAChCmB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASjB,EAAc,CAClCkB,UAAW,UACXC,SAAS,IAEbf,EAAOC,QAAQY,SAAShB,EAAoB,CACxCiB,UAAW,UACXC,SAAS,IAEbf,EAAOC,QAAQY,SAASf,EAAkB,CACtCgB,UAAW,UACXC,SAAS,KC1BTC,CAAiBhB,GA2BjB,OAnBAA,EAAOiB,GAAGC,SAASC,QAAQ,UANP,6SAQpBnB,EAAOiB,GAAGC,SAASE,UAAU/B,EAAkB,CAC3CgC,KAAM,UACNC,QAASC,EAAuBvB,IAAW,uBAC3CwB,SAAU,KACNC,EAAAA,oBAAoBzB,MAI5BA,EAAOiB,GAAGC,SAASQ,YAAYrC,EAAkB,CAC7CsC,KAAM,gBACNN,KAAM,UACNO,QAAS,sBACTJ,SAAU,KACNC,EAAAA,oBAAoBzB,MAIrBO,KAGXF,EAAQ,CAAC,GAAGjB,WAAoByC"}