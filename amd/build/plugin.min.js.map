{"version":3,"file":"plugin.min.js","sources":["../src/common.js","../src/options.js","../src/plugin.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Pumukitmedia common values.\n *\n * @module      tiny_pumukitmedia/common\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport const pluginName = 'tiny_pumukitmedia/plugin';\nexport const component = 'tiny_pumukitmedia';\nexport const pluginButtonName = 'pumukitmedia';\n","/**\n * Options helper for the Moodle Tiny Pumukitmedia plugin.\n *\n * @module      tiny_pumukitmedia/options\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {pluginName} from './common';\nimport {getPluginOptionName} from 'editor_tiny/options';\n\nconst urlOption = getPluginOptionName(pluginName, 'pumukitmediaurl');\nconst titleOption = getPluginOptionName(pluginName, 'dialogtitle');\nconst usernameOption = getPluginOptionName(pluginName, 'username');\nconst emailOption = getPluginOptionName(pluginName, 'email');\nconst hashOption = getPluginOptionName(pluginName, 'hash');\n\nexport const register = (editor) => {\n    editor.options.register(urlOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(titleOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(usernameOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(emailOption, {\n        processor: 'string',\n        default: '',\n    });\n    editor.options.register(hashOption, {\n        processor: 'string',\n        default: '',\n    });\n};\n\n// Funciones de ayuda\nexport const getPumukitUrl = (editor) => {\n    const value = editor.options.get(urlOption);\n    return typeof value === 'string' ? value.trim() : '';\n};\nexport const getDialogTitle = (editor) => editor.options.get(titleOption);\nexport const getUsername = (editor) => editor.options.get(usernameOption);\nexport const getEmail = (editor) => editor.options.get(emailOption);\nexport const getHash = (editor) => editor.options.get(hashOption);\n","import {getTinyMCE} from 'editor_tiny/loader';\nimport {getPluginMetadata} from 'editor_tiny/utils';\nimport {openPumukitDialogue} from 'tiny_pumukitmedia/dialogue';\nimport * as Configuration from 'tiny_pumukitmedia/configuration';\nimport * as Options from './options';\nimport {\n    component,\n    pluginName,\n    pluginButtonName\n} from './common';\n\n/**\n * Tiny PumukitMedia plugin for Moodle.\n *\n * @module      tiny_pumukitmedia/plugin\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nexport default new Promise(async (resolve) => {\n    const [tinymce, pluginMetadata] = await Promise.all([\n        getTinyMCE(),\n        getPluginMetadata(component, pluginName)\n    ]);\n\n    tinymce.PluginManager.add(`${component}/plugin`, (editor) => {\n        Options.register(editor);\n\n        const pumukitIcon = `\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1Zm1 2v14h14V5H5Zm4.8 2.6 5.6 4a.5.5 0 0 1 0 .8l-5.6 4A.5.5 0 0 1 9 16V8a.5.5 0 0 1 .8-.4Z\" fill=\"red\"></path>\n            </svg>\n        `;\n\n        editor.ui.registry.addIcon('pumukit', pumukitIcon);\n\n        editor.ui.registry.addButton(pluginButtonName, {\n            icon: 'pumukit',\n            tooltip: Options.getDialogTitle(editor) || 'Insert PuMuKIT Media',\n            onAction: () => {\n                openPumukitDialogue(editor);\n            }\n        });\n\n        editor.ui.registry.addMenuItem(pluginButtonName, {\n            text: 'Pumukit Media',\n            icon: 'pumukit',\n            classes: 'pumukitmedia-button',\n            onAction: () => {\n                openPumukitDialogue(editor);\n            }\n        });\n\n        return pluginMetadata;\n    });\n\n    resolve([`${component}/plugin`, Configuration]);\n});\n"],"names":["pluginName","component","pluginButtonName","urlOption","getPluginOptionName","titleOption","usernameOption","emailOption","hashOption","getDialogTitle","editor","options","get","Promise","async","resolve","tinymce","pluginMetadata","all","getTinyMCE","getPluginMetadata","PluginManager","add","register","processor","default","Options.register","ui","registry","addIcon","addButton","icon","tooltip","Options.getDialogTitle","onAction","openPumukitDialogue","addMenuItem","text","classes","Configuration"],"mappings":";;;;;;OAsBO,MAAMA,EAAa,2BACbC,EAAY,oBACZC,EAAmB,eCd1BC,EAAYC,EAAAA,oBAAoBJ,EAAY,mBAC5CK,EAAcD,EAAAA,oBAAoBJ,EAAY,eAC9CM,EAAiBF,EAAAA,oBAAoBJ,EAAY,YACjDO,EAAcH,EAAAA,oBAAoBJ,EAAY,SAC9CQ,EAAaJ,EAAAA,oBAAoBJ,EAAY,QA8BtCS,EAAkBC,GAAWA,EAAOC,QAAQC,IAAIP,UC3B9C,IAAIQ,SAAQC,MAAOC,IAC9B,MAAOC,EAASC,SAAwBJ,QAAQK,IAAI,CAChDC,eACAC,EAAiBA,kBAACnB,EAAWD,KAGjCgB,EAAQK,cAAcC,IAAI,GAAGrB,YAAqBS,IDP9B,CAACA,IACrBA,EAAOC,QAAQY,SAASpB,EAAW,CAC/BqB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASlB,EAAa,CACjCmB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASjB,EAAgB,CACpCkB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAAShB,EAAa,CACjCiB,UAAW,SACXC,QAAS,KAEbf,EAAOC,QAAQY,SAASf,EAAY,CAChCgB,UAAW,SACXC,QAAS,MCXTC,CAAiBhB,GA2BjB,OAnBAA,EAAOiB,GAAGC,SAASC,QAAQ,UANP,6SAQpBnB,EAAOiB,GAAGC,SAASE,UAAU5B,EAAkB,CAC3C6B,KAAM,UACNC,QAASC,EAAuBvB,IAAW,uBAC3CwB,SAAU,KACNC,EAAAA,oBAAoBzB,MAI5BA,EAAOiB,GAAGC,SAASQ,YAAYlC,EAAkB,CAC7CmC,KAAM,gBACNN,KAAM,UACNO,QAAS,sBACTJ,SAAU,KACNC,EAAAA,oBAAoBzB,MAIrBO,KAGXF,EAAQ,CAAC,GAAGd,WAAoBsC"}